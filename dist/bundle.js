/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
var __webpack_exports__ = {};
/*!*********************!*\
  !*** ./src/game.ts ***!
  \*********************/

// import EventModule from './event.ts';
const GAME_BOARD = [
    "~~~~~~~~~~~~~~~~~~~~",
    "~~~~~~~~~~~~~~~~~~~~",
    "~~~~~~~~~~~~~~~~~~~~",
    "~~~~~~~~~~~~~~~~~~~~",
    "~~~~~~~~~~~~~~~~~~~~"
];
const LOW_LEVEL_PLANTS = ['.', ','];
const MED_LEVEL_PLANTS = ['*', '~', '^'];
const HIGH_LEVEL_PLANTS = ['#', '%', '&'];
const NUM_OPEN_SPACES = 100;
const INVENTORY_SPACE = 15;
const START_PLANTS = 3;
function getRandomElementFromArray(arr) {
    // Check if the array is empty
    if (arr.length === 0) {
        return ""; // Return undefined if the array is empty
    }
    // Generate a random index between 0 and the length of the array minus 1
    const randomIndex = Math.floor(Math.random() * arr.length);
    // Return the random element from the array
    return arr[randomIndex];
}
class EventHandler {
    constructor(plot, inventory, market) {
        this.plot = plot;
        this.inventory = inventory;
        this.market = market;
        this.initializeEventListeners();
    }
    initializeEventListeners() {
        this.initializePlot();
        this.initializeInventory();
        this.initializeMarket();
    }
    // TODO populate rows at once instead of incrementally
    initializePlot() {
        let counter = 0;
        for (let i = 0; i < this.plot.board.length; i++) {
            let row = this.plot.board[i];
            for (let j = 0; j < row.length; j++) {
                let char = row[j];
                let $span = $(`<span id=slot${counter}>`).text(char);
                $span.addClass("slot");
                counter += 1;
                $span.on('mouseover', this.plot.displayPlant)
                    .on('mouseleave', () => { $("#selectedSpace").html(""); });
                $("#plot1").append($span);
            }
            $("#plot1").append('\n');
        }
    }
    initializeInventory() {
        for (let i = 0; i < INVENTORY_SPACE; i++) {
            let $space = $(`<div id=inventory${i}>`).text("empty");
            $("#inventory_contents").append($space);
            $space.on("mouseover", () => {
                $space.addClass("hovering");
            }).on("mouseleave", () => {
                $space.removeClass("hovering");
            }).on("click", () => {
                $space.removeClass("hovering");
                $space.addClass("selected");
                $space.on("click", () => {
                    $space.removeClass("selected");
                });
                let parsedString = this.parseString($space.html());
                if (parsedString !== "") {
                    this.addPlantSeed(parsedString);
                }
            });
        }
    }
    parseString(str) {
        const inputString = "- wheat: 3";
        const match = inputString.match(/\b\w+\b/);
        if (match) {
            return match[0];
        }
        else {
            return "";
        }
    }
    addPlantSeed(seed) {
        $("#board_container").children().each((index, board) => {
            $(board).children().each((index, element) => {
                $(element).on("mouseover", () => {
                    $(element).addClass("hovering");
                }).on("mouseleave", () => {
                    $(element).removeClass("hovering");
                }).on("click", () => {
                    $(element).removeClass("hovering");
                    this.plot.plant(index, seed);
                });
            });
        });
    }
    initializeMarket() {
    }
}
class Plant {
    constructor(species) {
        this.level = 0;
        this.species = species;
    }
    display() {
        // TODO
    }
}
class Plot {
    constructor() {
        this.board = GAME_BOARD;
        this.contents = new Map();
        this.displayPlant = this.displayPlant.bind(this);
    }
    displayPlant(event) {
        let slot = event.target;
        let id = slot.id[5];
        if (this.contents.has(id)) {
            let plant = this.contents.get(id);
            if (plant) {
                plant.display();
            }
        }
        else {
            $("#selectedSpace").html("empty");
        }
    }
    plant(id, seed) {
        let space = $(`#slot${id}`);
        let icon = getRandomElementFromArray(LOW_LEVEL_PLANTS);
        space.html(icon);
        space.css("color", "green");
        this.contents.set(id, new Plant(seed));
        return true;
    }
}
class Inventory {
    constructor() {
        this.contents = new Map();
        this.insert("wheat", START_PLANTS);
    }
    selectSpace() {
        $("#plot1").children().each((index, element) => {
            $(element).on("mouseenter", () => {
                $(element).addClass("hovering");
            }).on("mouseleave", () => {
                $(element).removeClass("hovering");
            }).on("click", () => {
                $(element).removeClass("hovering");
            });
        });
    }
    insert(seed, number) {
        for (let i = 1; i <= INVENTORY_SPACE; i++) {
            if (!this.contents.hasOwnProperty(i)) {
                let val = {
                    plant: seed,
                    quantity: number
                };
                this.contents.set(i, val);
                return i;
            }
        }
        return 0;
    }
}
class Market {
}
class Game {
    constructor() {
        this.plot = new Plot();
        this.inventory = new Inventory();
        this.market = new Market();
        this.eventHandler = new EventHandler(this.plot, this.inventory, this.market);
        this.inventory.insert("wheat", 3);
        $("#inventory0").html("- wheat: 3");
    }
}
// const test = EventModule;
const game = new Game();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUUsQ0FBQyxJQUFJLGVBQWUsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBQ3hDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO2dCQUNuQyxJQUFJLEdBQUcsR0FBRztvQkFDTixLQUFLLEVBQUUsSUFBSTtvQkFDWCxRQUFRLEVBQUUsTUFBTTtpQkFDbkI7Z0JBQ0QsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO2dCQUMxQixPQUFPLENBQUMsQ0FBQztZQUNiLENBQUM7UUFDTCxDQUFDO1FBQ0QsT0FBTyxDQUFDLENBQUM7SUFDYixDQUFDO0NBQ0o7QUFFRCxNQUFNLE1BQU07Q0FFWDtBQUVELE1BQU0sSUFBSTtJQU1OO1FBQ0ksSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxTQUFTLEVBQUUsQ0FBQztRQUNqQyxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksTUFBTSxFQUFFLENBQUM7UUFDM0IsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzdFLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNsQyxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQ3hDLENBQUM7Q0FDSjtBQUVELDRCQUE0QjtBQUM1QixNQUFNLElBQUksR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbHMvLi9zcmMvZ2FtZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgRXZlbnRNb2R1bGUgZnJvbSAnLi9ldmVudC50cyc7XG5cbmNvbnN0IEdBTUVfQk9BUkQgPSBbXG4gICAgXCJ+fn5+fn5+fn5+fn5+fn5+fn5+flwiLFxuICAgIFwifn5+fn5+fn5+fn5+fn5+fn5+fn5cIixcbiAgICBcIn5+fn5+fn5+fn5+fn5+fn5+fn5+XCIsXG4gICAgXCJ+fn5+fn5+fn5+fn5+fn5+fn5+flwiLFxuICAgIFwifn5+fn5+fn5+fn5+fn5+fn5+fn5cIlxuXTtcblxuY29uc3QgTE9XX0xFVkVMX1BMQU5UUyA9IFsnLicsICcsJ107XG5jb25zdCBNRURfTEVWRUxfUExBTlRTID0gWycqJywgJ34nLCAnXiddO1xuY29uc3QgSElHSF9MRVZFTF9QTEFOVFMgPSBbJyMnLCAnJScsICcmJ107XG5cbmNvbnN0IE5VTV9PUEVOX1NQQUNFUyA9IDEwMDtcblxuY29uc3QgSU5WRU5UT1JZX1NQQUNFID0gMTU7XG5cbmNvbnN0IFNUQVJUX1BMQU5UUyA9IDM7XG5cbmZ1bmN0aW9uIGdldFJhbmRvbUVsZW1lbnRGcm9tQXJyYXkoYXJyOiBzdHJpbmdbXSkge1xuICAgIC8vIENoZWNrIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICAgIGlmIChhcnIubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBcIlwiOyAvLyBSZXR1cm4gdW5kZWZpbmVkIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICAgIH1cblxuICAgIC8vIEdlbmVyYXRlIGEgcmFuZG9tIGluZGV4IGJldHdlZW4gMCBhbmQgdGhlIGxlbmd0aCBvZiB0aGUgYXJyYXkgbWludXMgMVxuICAgIGNvbnN0IHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYXJyLmxlbmd0aCk7XG5cbiAgICAvLyBSZXR1cm4gdGhlIHJhbmRvbSBlbGVtZW50IGZyb20gdGhlIGFycmF5XG4gICAgcmV0dXJuIGFycltyYW5kb21JbmRleF07XG59XG5cblxuY2xhc3MgRXZlbnRIYW5kbGVyIHtcbiAgICBwcml2YXRlIHBsb3Q6IFBsb3Q7XG4gICAgcHJpdmF0ZSBpbnZlbnRvcnk6IEludmVudG9yeTtcbiAgICBwcml2YXRlIG1hcmtldDogTWFya2V0O1xuXG4gICAgY29uc3RydWN0b3IocGxvdDogUGxvdCwgaW52ZW50b3J5OiBJbnZlbnRvcnksIG1hcmtldDogTWFya2V0KSB7XG4gICAgICAgIHRoaXMucGxvdCA9IHBsb3Q7XG4gICAgICAgIHRoaXMuaW52ZW50b3J5ID0gaW52ZW50b3J5O1xuICAgICAgICB0aGlzLm1hcmtldCA9IG1hcmtldDtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGluaXRpYWxpemVFdmVudExpc3RlbmVycygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplUGxvdCgpO1xuICAgICAgICB0aGlzLmluaXRpYWxpemVJbnZlbnRvcnkoKTtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplTWFya2V0KCk7XG4gICAgfVxuXG4gICAgLy8gVE9ETyBwb3B1bGF0ZSByb3dzIGF0IG9uY2UgaW5zdGVhZCBvZiBpbmNyZW1lbnRhbGx5XG4gICAgcHJpdmF0ZSBpbml0aWFsaXplUGxvdCgpOiB2b2lkIHtcbiAgICAgICAgbGV0IGNvdW50ZXIgPSAwO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucGxvdC5ib2FyZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbGV0IHJvdyA9IHRoaXMucGxvdC5ib2FyZFtpXTtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgcm93Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgbGV0IGNoYXIgPSByb3dbal07XG4gICAgICAgICAgICAgICAgbGV0ICRzcGFuID0gJChgPHNwYW4gaWQ9c2xvdCR7Y291bnRlcn0+YCkudGV4dChjaGFyKTtcbiAgICAgICAgICAgICAgICAkc3Bhbi5hZGRDbGFzcyhcInNsb3RcIik7XG4gICAgICAgICAgICAgICAgY291bnRlciArPSAxO1xuICAgICAgICAgICAgICAgICRzcGFuLm9uKCdtb3VzZW92ZXInLCB0aGlzLnBsb3QuZGlzcGxheVBsYW50KVxuICAgICAgICAgICAgICAgICAgICAub24oJ21vdXNlbGVhdmUnLCAoKSA9PiB7ICQoXCIjc2VsZWN0ZWRTcGFjZVwiKS5odG1sKFwiXCIpOyB9KTtcblxuICAgICAgICAgICAgICAgICQoXCIjcGxvdDFcIikuYXBwZW5kKCRzcGFuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICQoXCIjcGxvdDFcIikuYXBwZW5kKCdcXG4nKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaW5pdGlhbGl6ZUludmVudG9yeSgpOiB2b2lkIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBJTlZFTlRPUllfU1BBQ0U7IGkrKykge1xuICAgICAgICAgICAgbGV0ICRzcGFjZSA9ICQoYDxkaXYgaWQ9aW52ZW50b3J5JHtpfT5gKS50ZXh0KFwiZW1wdHlcIik7XG4gICAgICAgICAgICAkKFwiI2ludmVudG9yeV9jb250ZW50c1wiKS5hcHBlbmQoJHNwYWNlKTtcbiAgICAgICAgICAgICRzcGFjZS5vbihcIm1vdXNlb3ZlclwiLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgJHNwYWNlLmFkZENsYXNzKFwiaG92ZXJpbmdcIik7XG4gICAgICAgICAgICB9KS5vbihcIm1vdXNlbGVhdmVcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICRzcGFjZS5yZW1vdmVDbGFzcyhcImhvdmVyaW5nXCIpO1xuICAgICAgICAgICAgfSkub24oXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgJHNwYWNlLnJlbW92ZUNsYXNzKFwiaG92ZXJpbmdcIik7XG4gICAgICAgICAgICAgICAgJHNwYWNlLmFkZENsYXNzKFwic2VsZWN0ZWRcIik7XG4gICAgICAgICAgICAgICAgJHNwYWNlLm9uKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAkc3BhY2UucmVtb3ZlQ2xhc3MoXCJzZWxlY3RlZFwiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBsZXQgcGFyc2VkU3RyaW5nID0gdGhpcy5wYXJzZVN0cmluZygkc3BhY2UuaHRtbCgpKTtcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VkU3RyaW5nICE9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkUGxhbnRTZWVkKHBhcnNlZFN0cmluZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHBhcnNlU3RyaW5nKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgaW5wdXRTdHJpbmcgPSBcIi0gd2hlYXQ6IDNcIjtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBpbnB1dFN0cmluZy5tYXRjaCgvXFxiXFx3K1xcYi8pO1xuICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgIHJldHVybiBtYXRjaFswXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICBwcml2YXRlIGFkZFBsYW50U2VlZChzZWVkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgJChcIiNib2FyZF9jb250YWluZXJcIikuY2hpbGRyZW4oKS5lYWNoKChpbmRleCwgYm9hcmQpID0+IHtcbiAgICAgICAgICAgICQoYm9hcmQpLmNoaWxkcmVuKCkuZWFjaCgoaW5kZXgsIGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgICAgICAkKGVsZW1lbnQpLm9uKFwibW91c2VvdmVyXCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgJChlbGVtZW50KS5hZGRDbGFzcyhcImhvdmVyaW5nXCIpO1xuICAgICAgICAgICAgICAgIH0pLm9uKFwibW91c2VsZWF2ZVwiLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICQoZWxlbWVudCkucmVtb3ZlQ2xhc3MoXCJob3ZlcmluZ1wiKTtcbiAgICAgICAgICAgICAgICB9KS5vbihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgJChlbGVtZW50KS5yZW1vdmVDbGFzcyhcImhvdmVyaW5nXCIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsb3QucGxhbnQoaW5kZXgsIHNlZWQpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGluaXRpYWxpemVNYXJrZXQoKTogdm9pZCB7XG5cbiAgICB9XG5cblxufVxuXG5jbGFzcyBQbGFudCB7XG4gICAgcHJpdmF0ZSBsZXZlbDogbnVtYmVyO1xuICAgIHB1YmxpYyBzcGVjaWVzOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3RvcihzcGVjaWVzOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5sZXZlbCA9IDA7XG4gICAgICAgIHRoaXMuc3BlY2llcyA9IHNwZWNpZXM7XG4gICAgfVxuXG4gICAgcHVibGljIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIC8vIFRPRE9cbiAgICB9XG59XG5cbmNsYXNzIFBsb3Qge1xuICAgIHByaXZhdGUgY29udGVudHM6IE1hcDxudW1iZXIsIFBsYW50PjtcbiAgICBwdWJsaWMgYm9hcmQ6IHN0cmluZ1tdID0gR0FNRV9CT0FSRDtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmNvbnRlbnRzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmRpc3BsYXlQbGFudCA9IHRoaXMuZGlzcGxheVBsYW50LmJpbmQodGhpcyk7XG4gICAgfVxuXG5cbiAgICBwdWJsaWMgZGlzcGxheVBsYW50KGV2ZW50OiB7IHRhcmdldDogYW55OyB9KTogdm9pZCB7XG4gICAgICAgIGxldCBzbG90ID0gZXZlbnQudGFyZ2V0O1xuICAgICAgICBsZXQgaWQgPSBzbG90LmlkWzVdO1xuICAgICAgICBpZiAodGhpcy5jb250ZW50cy5oYXMoaWQpKSB7XG4gICAgICAgICAgICBsZXQgcGxhbnQgPSB0aGlzLmNvbnRlbnRzLmdldChpZCk7XG4gICAgICAgICAgICBpZiAocGxhbnQpIHtcbiAgICAgICAgICAgICAgICBwbGFudC5kaXNwbGF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkKFwiI3NlbGVjdGVkU3BhY2VcIikuaHRtbChcImVtcHR5XCIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHBsYW50KGlkOiBudW1iZXIsIHNlZWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgc3BhY2UgPSAkKGAjc2xvdCR7aWR9YCk7XG4gICAgICAgIGxldCBpY29uID0gZ2V0UmFuZG9tRWxlbWVudEZyb21BcnJheShMT1dfTEVWRUxfUExBTlRTKTtcbiAgICAgICAgc3BhY2UuaHRtbChpY29uKTtcbiAgICAgICAgc3BhY2UuY3NzKFwiY29sb3JcIiwgXCJncmVlblwiKTtcbiAgICAgICAgdGhpcy5jb250ZW50cy5zZXQoaWQsIG5ldyBQbGFudChzZWVkKSk7XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxufVxuXG5pbnRlcmZhY2UgSW52ZW50b3J5VmFsdWUge1xuICAgIHBsYW50OiBzdHJpbmc7XG4gICAgcXVhbnRpdHk6IG51bWJlcjtcbn1cblxuY2xhc3MgSW52ZW50b3J5IHtcbiAgICBwcml2YXRlIGNvbnRlbnRzOiBNYXA8bnVtYmVyLCBJbnZlbnRvcnlWYWx1ZT47XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5jb250ZW50cyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5pbnNlcnQoXCJ3aGVhdFwiLCBTVEFSVF9QTEFOVFMpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2VsZWN0U3BhY2UoKTogdm9pZCB7XG4gICAgICAgICQoXCIjcGxvdDFcIikuY2hpbGRyZW4oKS5lYWNoKChpbmRleCwgZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgJChlbGVtZW50KS5vbihcIm1vdXNlZW50ZXJcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICQoZWxlbWVudCkuYWRkQ2xhc3MoXCJob3ZlcmluZ1wiKTtcbiAgICAgICAgICAgIH0pLm9uKFwibW91c2VsZWF2ZVwiLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgJChlbGVtZW50KS5yZW1vdmVDbGFzcyhcImhvdmVyaW5nXCIpO1xuICAgICAgICAgICAgfSkub24oXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgJChlbGVtZW50KS5yZW1vdmVDbGFzcyhcImhvdmVyaW5nXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHB1YmxpYyBpbnNlcnQoc2VlZDogc3RyaW5nLCBudW1iZXI6IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IElOVkVOVE9SWV9TUEFDRTsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY29udGVudHMuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgICAgICAgICBsZXQgdmFsID0ge1xuICAgICAgICAgICAgICAgICAgICBwbGFudDogc2VlZCxcbiAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IG51bWJlclxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnRzLnNldChpLCB2YWwpO1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbn1cblxuY2xhc3MgTWFya2V0IHtcblxufVxuXG5jbGFzcyBHYW1lIHtcbiAgICBwcml2YXRlIHBsb3Q6IFBsb3Q7XG4gICAgcHJpdmF0ZSBpbnZlbnRvcnk6IEludmVudG9yeTtcbiAgICBwcml2YXRlIG1hcmtldDogTWFya2V0O1xuICAgIHByaXZhdGUgZXZlbnRIYW5kbGVyOiBFdmVudEhhbmRsZXI7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5wbG90ID0gbmV3IFBsb3QoKTtcbiAgICAgICAgdGhpcy5pbnZlbnRvcnkgPSBuZXcgSW52ZW50b3J5KCk7XG4gICAgICAgIHRoaXMubWFya2V0ID0gbmV3IE1hcmtldCgpO1xuICAgICAgICB0aGlzLmV2ZW50SGFuZGxlciA9IG5ldyBFdmVudEhhbmRsZXIodGhpcy5wbG90LCB0aGlzLmludmVudG9yeSwgdGhpcy5tYXJrZXQpO1xuICAgICAgICB0aGlzLmludmVudG9yeS5pbnNlcnQoXCJ3aGVhdFwiLCAzKTtcbiAgICAgICAgJChcIiNpbnZlbnRvcnkwXCIpLmh0bWwoXCItIHdoZWF0OiAzXCIpO1xuICAgIH1cbn1cblxuLy8gY29uc3QgdGVzdCA9IEV2ZW50TW9kdWxlO1xuY29uc3QgZ2FtZSA9IG5ldyBHYW1lKCk7Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9